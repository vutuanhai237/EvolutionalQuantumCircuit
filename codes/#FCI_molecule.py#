import matplotlib.pyplot as plt
import numpy as np
from pyscf import gto, scf, fci

number = 200
basis = 'sto-6g'

distance = np.linspace(0.5, 2.5, number)
ground_energy = np.zeros(number)
excited_1_energy = np.zeros(number)
excited_2_energy = np.zeros(number)
excited_3_energy = np.zeros(number)

file = open(f"Li-H molecules-{basis}-{number}.txt", "w")

for i, dis in enumerate(distance):
  mol = gto.M(atom = f'Li 0 0 0; H 0 0 {dis}', basis=basis)
  m = scf.RHF(mol).run()

  fs = fci.FCI(mol, m.mo_coeff)
  fs.nroots = 4
  e, c = fs.kernel(verbose=5)

  nuc = mol.energy_nuc()

  ground_energy[i] = e[0]
  excited_1_energy[i] = e[1]
  excited_2_energy[i] = e[2]
  excited_3_energy[i] = e[3]

  file.write(f'{dis} {" "*(20-len(str(dis)))} {basis}  {e[0]-nuc} \n')

file.close()